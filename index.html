<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SecretWeave</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <div class="container">

    <!-- Header -->
    <header>
      <div class="logo-wrap">
        <div class="logo-icon">
          <svg viewBox="0 0 24 24">
            <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/>
          </svg>
        </div>
        <span class="logo-text">SecretWeave</span>
      </div>
      <h1>Weave your <span class="gradient">secrets</span><br />into plain sight</h1>
      <p class="tagline">Dual-layer cipher &nbsp;·&nbsp; Encrypt &amp; Decrypt</p>
    </header>

    <!-- Mode Toggle -->
    <div class="mode-switcher" role="group" aria-label="Cipher mode">
      <button class="mode-btn active" id="encryptBtn" onclick="setMode('encrypt')" aria-pressed="true">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
          <rect x="3" y="11" width="18" height="11" rx="2"/>
          <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
        </svg>
        Encrypt
      </button>
      <button class="mode-btn" id="decryptBtn" onclick="setMode('decrypt')" aria-pressed="false">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
          <rect x="3" y="11" width="18" height="11" rx="2"/>
          <path d="M7 11V7a5 5 0 0 1 9.9-1"/>
        </svg>
        Decrypt
      </button>
    </div>

    <!-- Input Card -->
    <div class="card mode-encrypt" id="inputCard">
      <div class="card-line"></div>

      <div class="card-top-row">
        <div class="mode-badge encrypt" id="modeBadge">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <rect x="3" y="11" width="18" height="11" rx="2"/>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
          </svg>
          Encrypting
        </div>
        <span class="char-count" id="charCount"></span>
      </div>

      <label class="section-label" for="inputText" id="inputLabel">Plain Text</label>
      <textarea id="inputText" placeholder="Type your plain text here…" spellcheck="false"></textarea>

      <!-- Live preview -->
      <div class="live-wrap">
        <span class="live-label">Live preview</span>
        <span class="live-text" id="livePreview">—</span>
      </div>

      <!-- Keys -->
      <div class="keys-grid">

        <!-- Shift -->
        <div class="key-section">
          <div class="section-label">Shift Number</div>
          <div class="shift-row">
            <button class="shift-btn" onclick="adjustShift(-1)" aria-label="Decrease">−</button>
            <div class="shift-display">
              <span class="shift-number" id="shiftDisplay">3</span>
              <span class="shift-label">positions</span>
            </div>
            <button class="shift-btn" onclick="adjustShift(1)" aria-label="Increase">+</button>
          </div>
          <input type="range" id="shiftSlider" min="1" max="25" value="3" class="shift-slider" oninput="syncSlider()" />
        </div>

        <!-- Keyword -->
        <div class="key-section">
          <label class="section-label" for="keywordInput">Keyword</label>
          <input
            type="text"
            id="keywordInput"
            placeholder="e.g. WEAVE"
            maxlength="30"
            autocomplete="off"
            spellcheck="false"
            style="text-transform:uppercase;"
          />
          <!-- Strength meter -->
          <div class="strength-wrap">
            <div class="strength-track">
              <div class="strength-bar" id="strengthBar"></div>
            </div>
            <span class="strength-label" id="strengthLabel">Weak</span>
          </div>
        </div>

      </div>

      <p class="key-hint">
        To decrypt, use the <strong>same shift number and keyword</strong>. Keep both secret.
      </p>

      <button class="btn-primary encrypt-mode" id="actionBtn" onclick="process()">
        <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
          <rect x="3" y="11" width="18" height="11" rx="2"/>
          <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
        </svg>
        Encrypt Message
      </button>
    </div>

    <!-- Output Card -->
    <div class="output-card mode-encrypt" id="outputCard">
      <div class="output-header">
        <div class="output-label">
          <div class="status-dot" id="statusDot"></div>
          <span id="outputLabel">Encrypted Output</span>
        </div>
        <div class="output-actions">
          <button class="btn-sm" id="copyBtn" onclick="copyOutput()" disabled>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <rect x="9" y="9" width="13" height="13" rx="2"/>
              <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
            </svg>
            Copy
          </button>
          <button class="btn-sm" id="swapBtn" onclick="swapToInput()" disabled>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <path d="M7 16V4m0 0L3 8m4-4l4 4M17 8v12m0 0l4-4m-4 4l-4-4"/>
            </svg>
            Use as Input
          </button>
          <button class="btn-sm" onclick="clearAll()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <path d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
            </svg>
            Clear
          </button>
        </div>
      </div>

      <div class="output-body" id="outputBody">
        <div class="output-placeholder" id="outputPlaceholder">
          <svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3">
            <rect x="3" y="11" width="18" height="11" rx="2"/>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
          </svg>
          <span id="placeholderText">Your encrypted output will appear here</span>
        </div>
        <div id="outputText" class="output-text" style="display:none;"></div>
      </div>

      <div class="char-map-wrap" id="charMapWrap" style="display:none;">
        <label class="char-map-toggle">
          <input type="checkbox" id="showCharMap" onchange="toggleCharMap()" />
          Show character mapping
        </label>
        <div class="char-map" id="charMapContainer" style="display:none;"></div>
      </div>
    </div>

    <!-- History -->
    <div class="history-card">
      <div class="section-label">Recent History</div>
      <div id="historyList"><p class="history-empty">No history yet</p></div>
    </div>

    <!-- Info Card -->
    <div class="info-card">
      <div class="section-label">How SecretWeave Works</div>
      <p class="info-description">
        <strong>SecretWeave</strong> uses a dual-layer cipher. Each letter is transformed
        by two independent keys — your shift number and your keyword — making it
        significantly harder to break than a single-key cipher.
      </p>

      <div class="info-grid">
        <div class="info-item">
          <div class="info-num">01</div>
          <h3>Shift Layer</h3>
          <p>Every letter shifts forward (or backward) by your chosen number (1–25).</p>
        </div>
        <div class="info-item">
          <div class="info-num">02</div>
          <h3>Keyword Layer</h3>
          <p>Each keyword letter adds an extra offset to the corresponding message letter. The keyword cycles across the message.</p>
        </div>
        <div class="info-item">
          <div class="info-num">03</div>
          <h3>Combined</h3>
          <p>Both layers apply in one pass. You need the exact shift AND keyword to decrypt — neither alone works.</p>
        </div>
      </div>

      <div class="alpha-section">
        <div class="section-label">Alphabet Reference (A=0 … Z=25)</div>
        <div class="alpha-table" id="alphaTable"></div>
      </div>
    </div>

    <footer>
      <p>SecretWeave &nbsp;·&nbsp; Dual-layer cipher &nbsp;·&nbsp; Your cipher, your rules</p>
    </footer>

  </div>

  <div class="toast" id="toast" role="status" aria-live="polite">
    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
      <path d="M20 6L9 17l-5-5"/>
    </svg>
    <span id="toastMsg"></span>
  </div>

  <script src="script.js"></script>
</body>
</html>
